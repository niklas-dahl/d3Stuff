(function() {
  var barData, bars, drag, fill, height, i, j, k, plateData, plateHeight, plates, svg, topY, width;

  width = 960;

  height = 500;

  fill = d3.scale.category10();

  svg = d3.select('body').append('svg').attr('width', width).attr('height', height);

  plateHeight = 30;

  barData = [];

  for (i = j = 0; j <= 2; i = ++j) {
    barData.push({
      num: i,
      currentElmCount: 0,
      x: 100 + i * 200,
      y: 100,
      getTopY: function() {
        return (this.y + 355) - (this.currentElmCount * (plateHeight + 10));
      }
    });
  }

  bars = svg.selectAll('.turm').data(barData).enter().append('rect').attr('class', 'turm').attr('x', function(d) {
    return d.x;
  }).attr('y', function(d) {
    return d.y;
  }).attr('width', 50).attr('height', 400);

  plateData = [];

  for (i = k = 5; k >= 1; i = --k) {
    plateData.push({
      size: i,
      position: 0,
      x: barData[0].x + 50 / 2 - ((i + 1) * 30 / 2),
      y: barData[0].getTopY()
    });
    barData[0].currentElmCount++;
  }

  topY = 80;

  drag = d3.behavior.drag();

  drag.on('drag', function(d, i) {
    d.y += d3.event.dy;
    if (d.y < topY) {
      d.x += d3.event.dx;
      if (d.dx) {
        d.x += d.dx;
        d.dx = 0;
      }
    } else {
      if (d.dx == null) {
        d.dx = 0;
      }
      d.dx += d3.event.dx;
    }
    return d3.select(this).attr('x', function(d) {
      return d.x;
    }).attr('y', function(d) {
      return d.y;
    });
  });

  plates = svg.selectAll('.plate').data(plateData).enter().append('rect').attr('id', function(d) {
    return "plate_" + d.size;
  }).attr('class', 'plate').attr('width', function(d) {
    return (d.size + 1) * 30;
  }).attr('height', plateHeight).attr('x', function(d) {
    return d.x;
  }).attr('y', function(d) {
    return d.y;
  });

  svg.select('#plate_1').transition().duration(1000).attr('y', topY).each('end', function() {
    console.log(d3.select(this));
    return d3.select(this).transition().attr('x', 0);
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,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Q0FGZjtBQXZFQSIsImZpbGUiOiJoYW5vaS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIndpZHRoID0gOTYwXHJcbmhlaWdodCA9IDUwMFxyXG5maWxsID0gZDMuc2NhbGUuY2F0ZWdvcnkxMCgpXHJcblxyXG5zdmcgPSBkMy5zZWxlY3QoJ2JvZHknKS5hcHBlbmQoJ3N2ZycpXHJcbiAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXHJcbiAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodClcclxuXHJcbnBsYXRlSGVpZ2h0ID0gMzBcclxuXHJcbiMgY3JlYXRlIHRoZSBiYXJzIGRhdGFcclxuYmFyRGF0YSA9IFtdXHJcbmZvciBpIGluIFswIC4uIDJdXHJcbiAgYmFyRGF0YS5wdXNoIHtcclxuICAgIG51bTogaVxyXG4gICAgY3VycmVudEVsbUNvdW50OiAwXHJcbiAgICB4OiAxMDAgKyBpKjIwMFxyXG4gICAgeTogMTAwXHJcbiAgICBnZXRUb3BZOiAoKSAtPlxyXG4gICAgICAodGhpcy55ICsgMzU1KSAtICh0aGlzLmN1cnJlbnRFbG1Db3VudCAqIChwbGF0ZUhlaWdodCsxMCkpXHJcbiAgfVxyXG5cclxuIyBjcmVhdGUgYmFyc1xyXG5iYXJzID0gc3ZnLnNlbGVjdEFsbCgnLnR1cm0nKS5kYXRhKGJhckRhdGEpLmVudGVyKClcclxuICAuYXBwZW5kKCdyZWN0JylcclxuICAuYXR0cignY2xhc3MnLCAndHVybScpXHJcbiAgLmF0dHIoJ3gnLCAoZCkgLT4gZC54KVxyXG4gIC5hdHRyKCd5JywgKGQpIC0+IGQueSlcclxuICAuYXR0cignd2lkdGgnLCA1MClcclxuICAuYXR0cignaGVpZ2h0JywgNDAwKVxyXG5cclxucGxhdGVEYXRhID0gW11cclxuZm9yIGkgaW4gWzUgLi4gMV1cclxuICBwbGF0ZURhdGEucHVzaCB7XHJcbiAgICBzaXplOiBpXHJcbiAgICBwb3NpdGlvbjogMFxyXG4gICAgeDogYmFyRGF0YVswXS54ICsgNTAvMiAtICgoaSsxKSozMC8yKVxyXG4gICAgeTogYmFyRGF0YVswXS5nZXRUb3BZKClcclxuICB9XHJcbiAgYmFyRGF0YVswXS5jdXJyZW50RWxtQ291bnQrKztcclxuXHJcbnRvcFkgPSA4MDtcclxuXHJcbiMgZHJhZyBiZWhhdmlvclxyXG5kcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpXHJcbmRyYWcub24gJ2RyYWcnLCAoZCwgaSkgLT5cclxuICBkLnkgKz0gZDMuZXZlbnQuZHlcclxuICBpZiBkLnkgPCB0b3BZXHJcbiAgICBkLnggKz0gZDMuZXZlbnQuZHhcclxuICAgIGlmKGQuZHgpXHJcbiAgICAgIGQueCArPSBkLmR4XHJcbiAgICAgIGQuZHggPSAwXHJcbiAgZWxzZVxyXG4gICAgaWYoIWQuZHg/KVxyXG4gICAgICBkLmR4ID0gMCBcclxuICAgIGQuZHggKz0gZDMuZXZlbnQuZHhcclxuXHJcbiAgIyB1cGRhdGUgcG9zaXRpb25cclxuICBkMy5zZWxlY3QodGhpcylcclxuICAgIC5hdHRyKCd4JywgKGQpIC0+IGQueClcclxuICAgIC5hdHRyKCd5JywgKGQpIC0+IGQueSlcclxuXHJcbnBsYXRlcyA9IHN2Zy5zZWxlY3RBbGwoJy5wbGF0ZScpLmRhdGEocGxhdGVEYXRhKS5lbnRlcigpXHJcbiAgLmFwcGVuZCgncmVjdCcpXHJcbiAgICAuYXR0cignaWQnLCAoZCkgLT4gXCJwbGF0ZV8je2Quc2l6ZX1cIilcclxuICAgIC5hdHRyKCdjbGFzcycsICdwbGF0ZScpXHJcbiAgICAuYXR0cignd2lkdGgnLCAoZCkgLT4gKGQuc2l6ZSsxKSozMClcclxuICAgIC5hdHRyKCdoZWlnaHQnLCBwbGF0ZUhlaWdodClcclxuICAgIC5hdHRyKCd4JywgKGQpIC0+IGQueClcclxuICAgIC5hdHRyKCd5JywgKGQpIC0+IGQueSlcclxuXHJcbnN2Zy5zZWxlY3QoJyNwbGF0ZV8xJykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApXHJcbiAgLmF0dHIoJ3knLCB0b3BZKVxyXG4gIC5lYWNoICdlbmQnLCAoKSAtPlxyXG4gICAgY29uc29sZS5sb2cgZDMuc2VsZWN0KHRoaXMpXHJcbiAgICBkMy5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmF0dHIoJ3gnLCAwKVxyXG5cclxuIyBzdmcuc2VsZWN0KCcjc2NoZWliZV8xJylcclxuIyAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneScsIHRvcFkpXHJcbiMgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3gnLCB0b3dlclBvc1hbMl0pXHJcbiMgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3knLCA0NjApXHJcbiMgICAuZWFjaCAoKSAtPlxyXG5cclxuIyAgICAgc3ZnLnNlbGVjdCgnI3NjaGVpYmVfMicpXHJcbiMgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgdG9wWSlcclxuIyAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3gnLCB0b3dlclBvc1hbMV0pXHJcbiMgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgNDYwKVxyXG4jICAgICAgIC5lYWNoICgpIC0+XHJcblxyXG4jICAgICAgICAgc3ZnLnNlbGVjdCgnI3NjaGVpYmVfMScpXHJcbiMgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneScsIHRvcFkpXHJcbiMgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneCcsIHRvd2VyUG9zWFsxXSlcclxuIyAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgNDIwKVxyXG4jICAgICAgICAgICAuZWFjaCAoKSAtPlxyXG5cclxuIyAgICAgICAgICAgICBzdmcuc2VsZWN0KCcjc2NoZWliZV8zJylcclxuIyAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneScsIHRvcFkpXHJcbiMgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3gnLCB0b3dlclBvc1hbMl0tMjApXHJcbiMgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3knLCA0NjApXHJcbiMgICAgICAgICAgICAgICAuZWFjaCAoKSAtPlxyXG5cclxuIyAgICAgICAgICAgICAgICAgc3ZnLnNlbGVjdCgnI3NjaGVpYmVfMScpXHJcbiMgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgdG9wWSlcclxuIyAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3gnLCB0b3dlclBvc1hbMF0pXHJcbiMgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgMzQwKVxyXG4jICAgICAgICAgICAgICAgICAgIC5lYWNoICgpIC0+XHJcblxyXG4jICAgICAgICAgICAgICAgICAgICAgc3ZnLnNlbGVjdCgnI3NjaGVpYmVfMicpXHJcbiMgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneScsIHRvcFkpXHJcbiMgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneCcsIHRvd2VyUG9zWFsyXS01KVxyXG4jICAgICAgICAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmF0dHIoJ3knLCA0MjApXHJcbiMgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoICgpIC0+XHJcblxyXG4jICAgICAgICAgICAgICAgICAgICAgICAgIHN2Zy5zZWxlY3QoJyNzY2hlaWJlXzEnKVxyXG4jICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgdG9wWSlcclxuIyAgICAgICAgICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkuZHVyYXRpb24oMTAwMCkuYXR0cigneCcsIHRvd2VyUG9zWFsyXSs2KVxyXG4jICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5hdHRyKCd5JywgMzgwKVxyXG4jICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2ggKCkgLT5cclxuXHJcblxyXG4iXX0=
